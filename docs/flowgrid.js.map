{"version":3,"file":"flowgrid.js","sources":["../src/config.js","../src/cache.js","../src/utils.js","../src/dragdrop.js","../src/event.js","../src/fg-container.vue","../src/fg-item.vue","../src/index.js"],"sourcesContent":["\n// 常量\nexport const CONSTANT = {\n\tTHROTTLE_TIME: 15                              \t  // 节流函数的间隔时间单位ms, FPS = 1000 / THROTTLE_TIME\n}\n\n// 全局配置\nexport const globalConfig = {\n\trow: 7,                                            // 网格布局的默认行,默认7行\n\tcol: 12,                                           // 网格布局的默认列,默认12列\n\tdistance: 5,                                       // 触发拖拽的拖拽距离,默认5px\n\tdraggable: true,                                   // 是否允许拖拽, 默认允许\n\tresizable: true,                                   // 是否允许缩放, 默认允许\n\tnodeMinW: 2,                                       // 节点块的最小宽度, 默认占2格\n\tnodeMinH: 2,                                       // 节点块的最小高度, 默认占2格\n\toverflow: 5,                                       // 当拖拽或缩放超出网格容器的溢出像素\n\tpadding: {                                         // 节点块之间的间距, 默认都为5px\n\t\ttop: 5,\n\t\tleft: 5,\n\t\tright: 5,\n\t\tbottom: 5\n\t},\n\tcellScale: {                                       // 单元格的宽高比例, 默认16:9\n\t\tw: 16,\n\t\th: 9\n\t},\n\taddNodeSize: {                                     // 添加节点的默认尺寸\n\t\tx: 0,\n\t\ty: 0,\n\t\tw: 2,\n\t\th: 2\n\t}\n}\n","// 缓存对象\nlet cache = {\n\tinit: function () {\n\t\tif (!this.arr) this.arr = [];\n\t},\n\tget: function (idx) {\n\t\t// 避免0的情况, if条件判断麻烦\n\t\treturn this.arr[idx - 1];\n\t},\n\tset: function (obj) {\n\t\tthis.arr.push(obj);\n\t\treturn this.index();\n\t},\n\tremove: function(index) {\n\t\tthis.arr.splice(index, 1);\n\t},\n\tindex: function () {\n\t\treturn this.arr.length;\n\t},\n\tlist: function() {\n\t\treturn this.arr;\n\t}\n};\n\nexport default cache;\n","\nimport {CONSTANT} from './config'\n\nlet utils = {\n\t// 节流函数\n\tthrottle: function (now) {\n\t\tlet time = new Date().getTime();\n\t\tthis.throttle = function (now) {\n\t\t\tif (now - time > CONSTANT.THROTTLE_TIME) {\n\t\t\t\ttime = now;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis.throttle(now);\n\t},\n\t// 查找DOM节点\n\tsearchUp: function (ele, type) {\n\t\tif (ele === document.body || ele === document) return undefined;   // 向上递归到顶就停\n\t\tif (ele.classList.contains(type)) return ele;\n\t\treturn this.searchUp(ele.parentNode, type);\n\t}\n}\n\nexport default utils;\n","import cache from './cache'\nimport utils from './utils'\n\n// 拖拽对象\nlet dragdrop = {\n\tisResize: false,            // 是否放大缩小\n\tdragNode: null,             // 拖拽节点的的关联的fg-item的vue对象\n\tdragElement: null,\t\t\t\t\t// 拖拽节点dom对象\n\tdragStart: function (event, offsetX, offsetY, ele, isResize) {\n\t\t// 取得vue网格对象 flowgrid === fg-container.vue\n\t\tvar container = this.container = utils.searchUp(ele, 'fg-layout');\n\t\tvar flowgrid = this.flowgrid = cache.get(container.getAttribute('index'));\n\t\t// 配置项, 禁用拖拽\n\t\tif (!flowgrid.opt.draggable) return;\n\t\t// 取得当前vue被拖拽节点\n\t\tvar item = flowgrid.$children[ele.getAttribute('index') * 1];\n\t\t// 留存备份一份 this.dragNode === fg-item.vue\n\t\tthis.dragNode = item;\n\t\t// 将当前vue节点变成占位符, 控制样式\n\t\titem.placeholder = true;\n\t\t// 显示拖拽节点\n\t\tflowgrid.isDrag = true;\n\t\t// 将当前dom节点的内容区复制一份到拖拽节点\n\t\tvar dragElement = this.dragElement = container.querySelector('.fg-item-dragdrop');\n\t\tdragElement.setAttribute(\"style\", ele.getAttribute(\"style\"));\n\t\tdragElement.innerHTML = ele.innerHTML;\n\n\t\t// 计算偏移量, 点击节点时: 点击位置与节点的左上角定点的偏移距离\n\t\tvar containerOffset = container.getBoundingClientRect();\n\t\tthis.containerX = containerOffset.left;\n\t\tthis.containerY = containerOffset.top;\n\t\t// 判断是否点击了放大缩小\n\t\tif (isResize) {\n\t\t\tthis.isResize = isResize;\n\t\t\tthis.offsetX = offsetX || 0;\n\t\t\tthis.offsetY = offsetY || 0;\n\t\t} else {\n\t\t\tvar targetOffset = event.target.getBoundingClientRect();\n\t\t\tvar eleOffset = ele.getBoundingClientRect();\n\t\t\tthis.offsetX = targetOffset.left - eleOffset.left + offsetX || 0;\n\t\t\tthis.offsetY = targetOffset.top - eleOffset.top + offsetY || 0;\n\t\t}\n\t\tconsole.log(event.target);\n\t},\n\tdrag: function (event) {\n\t\tif (!this.dragNode) return;\n\t\t// 赋初值\n\t\tthis.prevX || (this.prevX = event.pageX);\n\t\tthis.prevY || (this.prevY = event.pageY);\n\t\t// 计算位移\n\t\tthis.dx = event.pageX - this.prevX;\n\t\tthis.dy = event.pageY - this.prevY;\n\t\t// 保存当前坐标变成上一次的坐标\n\t\tthis.prevX = event.pageX;\n\t\tthis.prevY = event.pageY;\n\t\t// 转换坐标\n\t\tthis.pageX = event.pageX;\n\t\tthis.pageY = event.pageY;\n\t\t// 判断是缩放还是拖拽\n\t\tthis.isResize ? this.resize() : this.position()\n\t},\n\tposition: function () {\n\t\tvar flowgrid = this.flowgrid;\n\t\tvar x = this.pageX - this.containerX - this.offsetX;\n\t\tvar y = this.pageY - this.containerY - this.offsetY;\n\t\t// 计算拖拽节点的坐标\n\t\tthis.dragElement.style.cssText += ';transform: translate(' + x + 'px,' + y + 'px);';\n\t\t// 极值判断\n\t\tvar maxW = flowgrid.opt.containerW;\n\t\tvar eleW = parseInt(this.dragElement.style.width);\n\t\tx < 0 && (x = 0);\n\t\ty < 0 && (y = 0);\n\t\tx + eleW > maxW && (x = maxW - eleW);\n\t\t// 当前拖拽节点的坐标, 转换成对齐网格的坐标\n\t\tvar node = this.dragNode.node;\n\t\tvar nodeX = Math.round(x / flowgrid.opt.cellW_Int);\n\t\tvar nodeY = Math.round(y / flowgrid.opt.cellH_Int);\n\t\t// 判断坐标是否变化\n\t\tif (node.x !== nodeX || node.y !== nodeY) {\n\t\t\tnode.x = nodeX;\n\t\t\tnode.y = nodeY;\n\t\t\tflowgrid.overlap(node, this.dx, this.dy, this.isResize);\n\t\t}\n\t},\n\tresize: function () {\n\t\t// debugger;\n\t\tvar flowgrid = this.flowgrid,\n\t\t\topt = flowgrid.opt,\n\t\t\tnode = this.dragNode.node,\n\t\t\tminW = node.minW * opt.cellW_Int - opt.padding.left - opt.padding.right - opt.overflow,\n\t\t\tminH = node.minH * opt.cellH_Int - opt.padding.top - opt.padding.bottom - opt.overflow,\n\t\t\ttranslate = this.dragElement.style.transform,\n\t\t\tcoord = translate.replace(/translate.*\\(/ig, '').replace(/\\).*$/ig, '').replace(/px/ig, '').split(','),\n\t\t\tx = parseInt(coord[0]),\n\t\t\ty = parseInt(coord[1]),\n\t\t\tw = this.pageX - this.containerX - x + this.offsetX,\n\t\t\th = this.pageY - this.containerY - y + this.offsetY;\n\t\t// 极值判断\n\t\tvar maxW = opt.containerW;\n\t\tw < minW && (w = minW);\n\t\th < minH && (h = minH);\n\t\tw + x > maxW && (w = maxW - x + opt.overflow);\n\t\t// 计算拖拽节点的宽高\n\t\tthis.dragElement.style.cssText += ';width: ' + w + 'px; height: ' + h + 'px;';\n\t\t// 判断宽高是否变化\n\t\tvar nodeW = Math.ceil(w / opt.cellW_Int);\n\t\tvar nodeH = Math.ceil(h / opt.cellH_Int);\n\t\tif (node.w !== nodeW || node.h !== nodeH) {\n\t\t\tnode.w = nodeW;\n\t\t\tnode.h = nodeH;\n\t\t\tflowgrid.overlap(node, this.dx, this.dy, this.isResize);\n\t\t}\n\t},\n\tdragEnd: function (event) {\n\t\tif (!this.dragNode) return;\n\t\t// 清空拖拽节点样式和内容\n\t\tthis.dragElement.removeAttribute('style');\n\t\tthis.dragElement.innerHTML = '';\n\t\t// 隐藏拖拽节点\n\t\tthis.flowgrid.isDrag = false;\n\t\t// 取消占位符样式\n\t\tthis.dragNode.placeholder = false;\n\t\t// 重置状态\n\t\tthis.isResize = false;\n\t\t// 临时变量\n\t\tdelete this.container;\n\t\tdelete this.flowgrid;\n\t\tdelete this.dragNode;\n\t\tdelete this.dragElement;\n\t\t// 删除偏移量\n\t\tdelete this.dx;\n\t\tdelete this.dy;\n\t\tdelete this.prevX;\n\t\tdelete this.prevY;\n\t\tdelete this.pageX;\n\t\tdelete this.pageY;\n\t\tdelete this.offsetX;\n\t\tdelete this.offsetY;\n\t\tdelete this.containerX;\n\t\tdelete this.containerY;\n\t}\n}\n\nexport default dragdrop;\n","import {globalConfig} from './config'\nimport utils from './utils'\nimport dragdrop from './dragdrop'\n\n// 事件处理对象\nlet handleEvent = {\n\tinit: function (isbind) {\n\t\tif (this.isbind) return;\n\t\tthis.isbind = isbind;\n\t\tthis.unbindEvent();\n\t\tthis.bindEvent();\n\t},\n\tdestroy: function () {\n\t\tthis.unbindEvent();\n\t},\n\tbindEvent: function () {\n\t\tdocument.addEventListener('mousedown', this.mouseDown, false);\n\t\tdocument.addEventListener('mousemove', this.mouseMove, false);\n\t\tdocument.addEventListener('mouseup', this.mouseUp, false);\n\t\tdocument.addEventListener('click', this.click, true);\n\t\tthis.isbind = true;\n\t},\n\tunbindEvent: function () {\n\t\tdocument.removeEventListener('mousedown', this.mouseDown, false);\n\t\tdocument.removeEventListener('mousemove', this.mouseMove, false);\n\t\tdocument.removeEventListener('mouseup', this.mouseUp, false);\n\t\tdocument.removeEventListener('click', this.click, true);\n\t\tthis.isbind = false;\n\t},\n\tmouseDown: function (event) {\n\t\tlet self = handleEvent;\n\t\t// 设置拖拽过程中禁用文本选中\n\t\tdocument.body.classList.add('fg-user-select-none');\n\t\t// 是否点击了拖拽节点\n\t\tlet ele = self.ele = utils.searchUp(event.target, 'fg-item');\n\t\tif (ele) {\n\t\t\tif (event.target.classList.contains('fg-item-zoom-bar')) {\n\t\t\t\tself.isResize = true;\n\t\t\t}\n\t\t\t// 记录位置, 通过比较拖拽距离来判断是否是拖拽, 如果是拖拽则阻止冒泡. 不触发点击事件\n\t\t\tself.dragStart = true;\n\t\t\tself.distance = globalConfig.distance;\n\t\t\tself.distanceX = event.pageX;\n\t\t\tself.distanceY = event.pageY;\n\t\t\tself.offsetX = event.offsetX || 0;\n\t\t\tself.offsetY = event.offsetY || 0;\n\t\t}\n\t},\n\tmouseMove: function (event) {\n\t\tlet self = handleEvent;\n\t\tif (!self.ele) return;\n\t\tif (self.dragStart && self.isDrag(event)) {\n\t\t\tself.dragStart = false;\n\t\t\tdragdrop.dragStart(event, self.offsetX, self.offsetY, self.ele, self.isResize);\n\t\t\treturn;\n\t\t}\n\t\tutils.throttle(new Date().getTime()) && dragdrop.drag(event);\n\t},\n\tmouseUp: function (event) {\n\t\tdocument.body.classList.remove('fg-user-select-none');\n\t\tdragdrop.dragEnd(event);\n\t\t// 清理临时变量\n\t\tlet self = handleEvent;\n\t\tdelete self.distance;\n\t\tdelete self.distanceX;\n\t\tdelete self.distanceY;\n\t\tdelete self.offsetX;\n\t\tdelete self.offsetY;\n\t\tdelete self.isResize;\n\t},\n\tclick: function (event) {\n\t\tlet self = handleEvent;\n\t\tif (self.dragStart === false) {\n\t\t\t// event.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tdelete self.dragStart\n\t\t}\n\t},\n\tisDrag: function (event) {\n\t\tvar self = handleEvent,\n\t\t\t\tdistanceX = Math.abs(event.pageX - self.distanceX || 0),\n\t\t\t\tdistanceY = Math.abs(event.pageY - self.distanceY || 0);\n\t\tif (self.distance < distanceX || self.distance < distanceY) {\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nexport default handleEvent;\n","<template>\n  <div class=\"fg-container\">\n    <div class=\"fg-layout\"\n         :index=\"index\"\n         :class=\"{'fg-no-draggable': !opt.draggable, 'fg-no-resizable': !opt.resizable}\">\n      <slot></slot>\n      <!-- 跟随鼠标移动的拖拽节点 -->\n      <div class=\"fg-item-dragdrop\" v-show=\"isDrag\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\n\n  import {globalConfig} from './config'\n  import cache from './cache'\n  import handleEvent from './event'\n\n  export default {\n    name: 'fg-container',\n    props: [\n      'setting',\n      'nodes'\n    ],\n    computed: {\n      opt: function () {\n        let options = Object.assign({}, globalConfig, this.setting || {});\n        this.computeCell(options);\n        return options;\n      }\n    },\n    data () {\n      return {\n        area: [],\n        index: 1,\n        isDrag: false,\n      }\n    },\n    methods: {\n      // 计算单元格\n      computeCell: function (opt) {\n        opt.cellW = opt.containerW / opt.col;\n        opt.cellH = opt.cellW / opt.cellScale.w * opt.cellScale.h;\n        opt.cellW_Int = Math.floor(opt.cellW);\n        opt.cellH_Int = Math.floor(opt.cellH);\n      },\n      init: function () {\n        handleEvent.init(true);\n        // 缓存对象\n        cache.init();\n        this.index = cache.set(this);\n        this.load();\n      },\n      load: function() {\n        // 初始矩阵区域并布局\n        this.buildArea();\n        this.layout();\n      },\n      // 构建网格区域\n      buildArea: function () {\n        let max = this.getMaxRowAndCol();\n        for (let r = 0; r < max.row; r++) {\n          this.area[r] = new Array(max.col);\n        }\n        this.putNodes();\n      },\n      // 取得区域中的最大行和列\n      getMaxRowAndCol: function () {\n        let opt = this.opt;\n        let nodes = this.nodes;\n        let max = {\n          row: opt.row,\n          col: opt.col\n        };\n        if (nodes && nodes.length > 0) {\n          for (let n of nodes) {\n            if (n.y + n.h > max.row) {\n              max.row = n.y + n.h;\n            }\n            if (n.x + n.w > max.col) {\n              max.col = n.x + n.w;\n            }\n          }\n        }\n        return max;\n      },\n      // 将数据铺进网格布局\n      putNodes: function () {\n        let r, c, rlen, clen;\n        for (let node of this.nodes) {\n          for (r = node.y, rlen = node.y + node.h; r < rlen; r++) {\n            for (c = node.x, clen = node.x + node.w; c < clen; c++) {\n              this.area[r][c] = node.id;\n            }\n          }\n        }\n      },\n      // 自动扫描空位添加节点\n      getNodeCoord: function (node) {\n        let nodes = this.nodes;\n        let area = this.area;\n        if (nodes.length === 0) return node;\n        var r, c, maxCol = area[0].length;\n        for (r = 0; r < area.length; r = r + 1) {\n          node.y = r;\n          for (c = 0; c < area[0].length; c = c + 1) {\n            node.x = c;\n            if (node.x + node.w > maxCol) {\n              node.x = 0;\n            }\n            if (!this.collision(area, node))\n              return node;\n          }\n        }\n        node.x = 0;  // area区域都占满了, 另起一行\n        node.y = r;\n        return node;\n      },\n      // 碰撞检测, 从左到右, 从上到下扫描\n      collision: function (area, node) {\n        for (let r = node.y; r < node.y + node.h; r++)\n          for (let c = node.x; c < node.x + node.w; c++)\n            if (area[r] && (area[r][c] || area[r][c] == 0))\n              return true;\n      },\n      // 流布局\n      layout: function () {\n        // 原理: 遍历数据集, 寻找节点上面是否有空行, 修改node.y, 进行上移.\n        for (let node of this.nodes) {\n          let y = this.findEmptyLine(node);\n          node.y > y && this.moveUp(node, y);\n        }\n      },\n      // 寻找空行, 扫描找到最接近顶部的空行是第几行\n      findEmptyLine: function (node) {\n        let r, c, cell, area = this.area;\n        for (r = node.y - 1; r >= 0; r--) {\n          for (c = node.x; c < node.x + node.w; c++) {\n            cell = area[r][c];\n            if (cell || cell == 0) {\n              return r + 1;\n            }\n          }\n        }\n        return 0;\n      },\n      // 上移\n      moveUp: function (node, newRow, newId) {\n        node.y = newRow;\n        newId && (node.id = newId)\n        for (let r = node.y; r < node.y + node.h; r++)\n          for (let c = node.x; c < node.x + node.w; c++)\n            this.area[r][c] = node.id;\n      },\n      // 调整大小\n      resize: function (containerW, containerH) {\n        this.opt.containerW = containerW;\n        this.computeCell(this.opt);\n        this.load();\n      },\n      // 碰撞检测, 两个矩形是否发生碰撞\n      checkHit: function (n, node) {\n        var result = false;\n        if ((n.x + n.w > node.x) && (n.x < node.x + node.w)) {\n          if ((n.y + n.h > node.y) && (n.y < node.y + node.h)) {\n            result = true;\n          }\n        }\n        return result;\n      },\n      // 节点重叠, 拖拽节点过程中, 将所有节点坐标重新计算\n      overlap: function (node, dx, dy, isResize) {\n        var nodes = this.nodes,\n          dx = dx || 0,\n          dy = dy || 0,\n          offsetNode = null,\n          offsetUnderY = 0,\n          offsetUpY = 0,\n          isResize = isResize || false,\n          checkHit = this.checkHit;\n        // 向下, 向左, 向右插入节点\n        if (!isResize) {\n          for(let n of nodes) {\n            if (n !== node && checkHit(n, node)) {\n              var val = n.y + n.h - node.y;\n              if (val > offsetUnderY) {\n                offsetUnderY = val;\n                offsetNode = n;\n              }\n            }\n          }\n          if (offsetNode) {\n            // 判断插入点应该上移还是下移, 通过重叠点的中间值h/2来判断\n            var median = offsetNode.h / 2 < 1 ? 1 : Math.floor(offsetNode.h / 2);\n            // 计算差值, 与中间值比较, dy > 2 下移(2是优化, 防止平移上下震动), 拿y+h来和中间值比较\n            var difference = (dy >= 2 && dy >= dx) ? node.y + node.h - offsetNode.y : node.y - offsetNode.y;\n            // 大于中间值, 求出下面那部分截断的偏移量, 等于是怕上下顺序连续的块,会错过互换位置\n            if (difference >= median) {\n              node.y = node.y + offsetUnderY;\n            }\n          }\n        }\n        // 向上插入节点\n        for(let n of nodes) {\n          if (n !== node && checkHit(n, node)) {\n            var val = node.y - n.y;\n            offsetUpY = val > offsetUpY ? val : offsetUpY;\n          }\n        }\n        // 重新计算y值\n        for(let n of nodes) {\n          if (n !== node) {\n            if ((n.y < node.y && node.y < n.y + n.h) || node.y <= n.y) {\n              n.y = n.y + node.h + offsetUpY;\n            }\n          }\n        }\n        return this;\n      }\n    },\n    created () {\n      // 早于fg-item的钩子mounted执行\n      this.init();\n    },\n    beforeUpdate () {\n      // 数据即将更新时重置区域, 并应用布局\n      this.load();\n    },\n    updated () {},\n    mounted () {},\n    destroyed () {\n      handleEvent.destroy();\n    }\n  }\n</script>\n\n<style>\n  /* 拖拽过程中阻止文本选中 */\n  body.fg-user-select-none {\n    user-select: none !important;\n  }\n\n  /* 响应式 */\n  @media screen and (max-width: 767px) {\n    .fg-layout {\n      width: auto !important;\n      margin: 0 10px;\n    }\n\n    .fg-layout:after {\n      content: \"\";\n      clear: both;\n    }\n\n    .fg-layout .fg-item-zoom-bar {\n      display: none;\n    }\n\n    .fg-item {\n      position: static;\n      width: 100% !important;\n      height: auto !important;\n      float: left !important;\n      transform: translate(0, 0) !important;\n      margin-bottom: 10px;\n    }\n  }\n\n  /* 插件外容器的样式 */\n  .fg-container {\n    position: relative;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n  }\n\n  /* 网络布局的外容器 */\n  .fg-layout {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  /* 当禁止缩放, 隐藏缩放句柄 */\n  .fg-layout.fg-no-resizable .fg-item-zoom-bar {\n    display: none;\n  }\n\n  /* 当禁用缩放或者拖拽, 恢复鼠标形状 */\n  .fg-layout.fg-no-draggable .fg-item,\n  .fg-layout.fg-no-resizable .fg-item {\n    cursor: default;\n  }\n\n  /* 节点块的样式 */\n  .fg-item {\n    cursor: pointer;\n    position: absolute;\n    z-index: 10;\n    background-color: #8fee2b;\n  }\n\n  /* 节点块的动画样式 */\n  .fg-item-animate {\n    -webkit-transform: translate3d(0, 0, 0);\n    -webkit-backface-visibility: hidden;\n    -webkit-transform-style: preserve-3d;\n    transition: transform 0.2s, height 0.2s, width 0.2s;\n  }\n\n  /* 拖拽过程中, 被拖拽的当前节点块补充占位样式 */\n  .fg-item-placeholder {\n    z-index: 1;\n  }\n  .fg-item-placeholder::before {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: #d3d3d3;\n    z-index: 2;\n  }\n\n  /* 拖拽过程中, 被拖拽的节点 */\n  .fg-item-dragdrop {\n    position: absolute;\n    z-index: 100;\n    box-shadow: 2px 2px 2px rgba(144, 142, 142, 0.6);\n    opacity: 0.8;\n    background-color: #8fee2b;\n  }\n\n   /* 节点块的内容区 */\n  .fg-item-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  /* 节点块的缩放句柄 */\n  .fg-item-zoom-bar {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    height: 24px;\n    width: 24px;\n    overflow: hidden;\n    z-index: 1;\n    cursor: se-resize;\n  }\n  .fg-item-zoom-bar:before {\n    content: \"\";\n    position: absolute;\n    z-index: 100;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background-color: aqua;\n  }\n\n</style>\n","<template>\n  <div class=\"fg-item fg-item-animate\"\n       :class=\"{'fg-item-placeholder': placeholder}\"\n       :style=\"itemStyle\"\n       :fg-id=\"node.id\"\n       :index=\"index\">\n    <div class=\"fg-item-content\">\n      <slot></slot>\n    </div>\n    <div class=\"fg-item-zoom-bar\" :fg-id=\"node.id\" :index=\"index\"></div>\n  </div>\n</template>\n\n<script>\n\n  export default {\n    name: 'fg-item',\n    props: [\n      'node', // {id:'2', x: 0, y: 0, w: 4, h: 4, minW: 2, minH: 2}\n      'index' // node在nodes中的索引值\n    ],\n    computed: {\n      itemStyle: function () {\n        let opt = this.$parent.opt;\n        let node = this.node;\n        return {\n          transform: \"translate(\" + (node.x * opt.cellW_Int) + \"px,\" + (node.y * opt.cellH_Int) + \"px)\",\n          width: (node.w * opt.cellW_Int - opt.padding.left - opt.padding.right) + 'px',\n          height: (node.h * opt.cellH_Int - opt.padding.top - opt.padding.bottom) + 'px'\n        }\n      }\n    },\n    data () {\n      return {\n        placeholder: false\n      }\n    },\n    mounted () {}\n  }\n</script>\n\n<style>\n</style>\n","import { version } from '../package.json';\nimport fgContainer from './fg-container.vue';\nimport fgItem from './fg-item.vue';\n\nexport default {\n\tversion,\n\tfgContainer,\n\tfgItem\n}\n"],"names":["CONSTANT","globalConfig","cache","arr","idx","obj","push","index","splice","length","utils","now","time","Date","getTime","throttle","THROTTLE_TIME","ele","type","document","body","undefined","classList","contains","searchUp","parentNode","dragdrop","event","offsetX","offsetY","isResize","container","flowgrid","get","getAttribute","opt","draggable","item","$children","dragNode","placeholder","isDrag","dragElement","querySelector","setAttribute","innerHTML","containerOffset","getBoundingClientRect","containerX","left","containerY","top","targetOffset","target","eleOffset","log","prevX","pageX","prevY","pageY","dx","dy","resize","position","x","y","style","cssText","maxW","containerW","eleW","parseInt","width","node","nodeX","Math","round","cellW_Int","nodeY","cellH_Int","overlap","minW","padding","right","overflow","minH","bottom","translate","transform","coord","replace","split","w","h","nodeW","ceil","nodeH","removeAttribute","handleEvent","isbind","unbindEvent","bindEvent","addEventListener","mouseDown","mouseMove","mouseUp","click","removeEventListener","self","add","dragStart","distance","distanceX","distanceY","drag","remove","dragEnd","stopPropagation","abs","options","Object","assign","setting","computeCell","cellW","col","cellH","cellScale","floor","init","set","load","buildArea","layout","max","getMaxRowAndCol","r","row","area","Array","putNodes","nodes","n","c","rlen","clen","id","maxCol","collision","findEmptyLine","moveUp","cell","newRow","newId","containerH","result","offsetNode","offsetUnderY","offsetUpY","checkHit","val","median","difference","destroy","$parent"],"mappings":"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"}